name: edl-dashboard-infra
on: 
 workflow_dispatch:
env: 
  willDeployToLowerEnvironments: 'true'
 
jobs:
  Build:
   strategy:
       matrix:
        node-version: ['8.10.0']
  
        envaccount: [ {env: devl, account: CIS_DEVL_AWS_ACCT}, {env: prod,account: CIS_PROD_AWS_ACCT }]
   runs-on: ubuntu-latest
   steps:
   - uses: actions/checkout@v1
   - name: PushToImage
     run: |
        echo "aws ecr get-login --no-include-email --region us-east-1"
        echo "docker build -t edl-dashboard-repo './infrastructure/docker/$environmentName'"
        echo "docker tag edl-dashboard-repo:latest '${currentAccountNumber}.dkr.ecr.us-east-1.amazonaws.com/edl-dashboard-repo:latest'"
        echo "docker push '${currentAccountNumber}.dkr.ecr.us-east-1.amazonaws.com/edl-dashboard-repo:latest'"
        echo "Image push complete"
   - name: Setup Node.js ${{ matrix.node-version }}
     uses: actions/setup-node@v2
     with: 
       
      node-version: ${{ matrix.node-version }}
      env:  ${{ matrix.envaccount.env }} source.env
            
            
            
    
      
  
      
